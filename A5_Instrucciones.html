<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Pr√°ctica - Limpieza de Datos | Universidad del SABES</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .section h2 {
            font-size: 2rem;
            color: #4a5568;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .platform-logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            font-weight: bold;
        }
        
        .powerbi-logo { background: linear-gradient(135deg, #f7b731, #5f27cd); }
        .python-logo { background: linear-gradient(135deg, #3776ab, #ffd43b); }
        .r-logo { background: linear-gradient(135deg, #165caa, #276dc3); }
        
        .step {
            background: rgba(103, 126, 234, 0.1);
            border-left: 5px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .step:hover {
            background: rgba(103, 126, 234, 0.15);
            transform: translateX(5px);
        }
        
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .step-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #4a5568;
            flex: 1;
            margin-left: 15px;
        }
        
        .checkpoint {
            background: rgba(46, 213, 115, 0.2);
            border: 2px solid #2ed573;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            user-select: none;
        }
        
        .checkpoint:hover {
            background: rgba(46, 213, 115, 0.3);
            transform: scale(1.02);
        }
        
        .checkpoint.completed {
            background: rgba(46, 213, 115, 0.4);
            border-color: #20bf6b;
        }
        
        .checkpoint input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .checkpoint label {
            cursor: pointer;
            flex: 1;
            font-weight: 500;
        }
        
        .code-container {
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .code-header {
            background: #4a5568;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }
        
        .code-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .code-actions {
            display: flex;
            gap: 8px;
        }
        
        .code-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background 0.3s ease;
        }
        
        .code-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            margin: 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
            white-space: pre-wrap;
            line-height: 1.4;
        }
        
        .code-comment {
            color: #68d391;
            font-style: italic;
        }
        
        .code-keyword {
            color: #63b3ed;
            font-weight: bold;
        }
        
        .code-string {
            color: #fbb6ce;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .comparison-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .comparison-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .speed-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .speed-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            flex: 1;
            overflow: hidden;
        }
        
        .speed-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .speed-fast { background: linear-gradient(90deg, #2ed573, #7bed9f); }
        .speed-medium { background: linear-gradient(90deg, #ffa726, #ffcc02); }
        .speed-slow { background: linear-gradient(90deg, #ff6b6b, #ee5a52); }
        
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .pros, .cons {
            padding: 15px;
            border-radius: 10px;
        }
        
        .pros {
            background: rgba(46, 213, 115, 0.1);
            border: 1px solid #2ed573;
        }
        
        .cons {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
        }
        
        .dataset-selector {
            background: rgba(116, 75, 162, 0.1);
            border: 2px solid #764ba2;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .dataset-option {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dataset-option:hover {
            border-color: #764ba2;
            background: rgba(116, 75, 162, 0.05);
        }
        
        .dataset-option.selected {
            border-color: #764ba2;
            background: rgba(116, 75, 162, 0.1);
        }
        
        .progress-tracker {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 300px;
            z-index: 1000;
        }
        
        .progress-bar-container {
            background: #e2e8f0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .alert {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .alert-warning {
            background: rgba(255, 107, 107, 0.1);
            border-color: #ff6b6b;
        }
        
        .alert-success {
            background: rgba(46, 213, 115, 0.1);
            border-color: #2ed573;
        }
        
        .alert-info {
            background: rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }
        
        .time-estimate {
            background: rgba(142, 68, 173, 0.1);
            border: 2px solid #8e44ad;
            border-radius: 10px;
            padding: 10px 15px;
            margin: 10px 0;
            display: inline-block;
            font-weight: bold;
            color: #8e44ad;
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2rem; }
            .section h2 { font-size: 1.5rem; }
            .comparison-grid { grid-template-columns: 1fr; }
            .pros-cons { grid-template-columns: 1fr; }
            .progress-tracker { 
                position: relative; 
                top: auto; 
                right: auto; 
                margin: 20px 0; 
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üßπ MANUAL DE PR√ÅCTICA - LIMPIEZA DE DATOS</h1>
            <p><strong>Universidad del SABES</strong> | Anal√≠tica de Datos | Sesi√≥n 5</p>
            <p>Profesor: Fausto No√© Jim√©nez | 10 de junio 2025</p>
            <div class="time-estimate">‚è±Ô∏è Tiempo estimado: 90 minutos</div>
        </div>

        <div class="progress-tracker">
            <h3>üìä Progreso General</h3>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="overallProgress"></div>
            </div>
            <p id="progressText">0% completado</p>
            <div style="margin-top: 15px;">
                <h4>üéØ Plataformas:</h4>
                <div style="font-size: 0.9rem;">
                    <div id="powerbiProgress">üìä Power BI: 0%</div>
                    <div id="pythonProgress">üêç Python: 0%</div>
                    <div id="rProgress">üìà R: 0%</div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n de Selecci√≥n de Dataset -->
        <div class="section">
            <h2>üìÅ PASO 1: SELECCI√ìN DE DATASET</h2>
            
            <div class="alert alert-info">
                <span style="font-size: 1.5rem;">üí°</span>
                <div>
                    <strong>Importante:</strong> Para esta pr√°ctica, utilizaremos datasets espec√≠ficos seg√∫n tu carrera. 
                    Si a√∫n no recibes tu dataset asignado, puedes practicar con los datasets de muestra disponibles.
                </div>
            </div>

            <div class="dataset-selector">
                <h3>üéØ Selecciona tu √°rea de estudio:</h3>
                
                <div class="dataset-option" onclick="selectDataset('admin')">
                    <strong>üíº Administraci√≥n y Desarrollo de Negocios</strong>
                    <p>Dataset de muestra: Customer Sales Data (ventas y demograf√≠a)</p>
                    <small>üìÅ Descarga: <a href="https://bit.ly/sabes-admin-data" target="_blank">bit.ly/sabes-admin-data</a></small>
                </div>
                
                <div class="dataset-option" onclick="selectDataset('ti')">
                    <strong>üíª Ingenier√≠a en Tecnolog√≠as de Informaci√≥n</strong>
                    <p>Dataset de muestra: Network Traffic Analysis (logs de red)</p>
                    <small>üìÅ Descarga: <a href="https://bit.ly/sabes-ti-data" target="_blank">bit.ly/sabes-ti-data</a></small>
                </div>
                
                <div class="dataset-option" onclick="selectDataset('industrial')">
                    <strong>üè≠ Ingenier√≠a Industrial</strong>
                    <p>Dataset de muestra: Manufacturing Quality Control (control de calidad)</p>
                    <small>üìÅ Descarga: <a href="https://bit.ly/sabes-industrial-data" target="_blank">bit.ly/sabes-industrial-data</a></small>
                </div>
                
                <div class="dataset-option" onclick="selectDataset('marketing')">
                    <strong>üì¢ Mercadotecnia</strong>
                    <p>Dataset de muestra: Digital Marketing Campaigns (campa√±as digitales)</p>
                    <small>üìÅ Descarga: <a href="https://bit.ly/sabes-marketing-data" target="_blank">bit.ly/sabes-marketing-data</a></small>
                </div>
            </div>

            <div class="checkpoint" onclick="toggleCheckpoint(this)">
                <input type="checkbox" id="dataset-downloaded">
                <label for="dataset-downloaded">‚úÖ He descargado mi dataset y est√° listo para trabajar</label>
            </div>
        </div>

        <!-- Comparaci√≥n de Plataformas -->
        <div class="section">
            <h2>‚öñÔ∏è COMPARACI√ìN DE PLATAFORMAS</h2>
            
            <div class="alert alert-warning">
                <span style="font-size: 1.5rem;">‚ö°</span>
                <div>
                    <strong>Filosof√≠a de trabajo:</strong> Cada plataforma tiene su enfoque √∫nico. 
                    Power BI es visual e intuitivo, Python es program√°tico y flexible, R es estad√≠stico y potente.
                </div>
            </div>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                        <div class="platform-logo powerbi-logo">PBI</div>
                        <h3>Power BI</h3>
                    </div>
                    
                    <div class="speed-indicator">
                        <strong>Velocidad de implementaci√≥n:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-fast" style="width: 90%;"></div>
                        </div>
                        <span>90%</span>
                    </div>
                    
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>‚úÖ Ventajas</h4>
                            <ul>
                                <li>Interfaz visual intuitiva</li>
                                <li>Detecci√≥n autom√°tica de tipos</li>
                                <li>Sin c√≥digo requerido</li>
                                <li>Integraci√≥n con Microsoft</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>‚ùå Limitaciones</h4>
                            <ul>
                                <li>Menos control granular</li>
                                <li>Dependiente de GUI</li>
                                <li>Costo de licencia</li>
                                <li>Menos automatizaci√≥n</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="comparison-card">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                        <div class="platform-logo python-logo">üêç</div>
                        <h3>Python (Colab)</h3>
                    </div>
                    
                    <div class="speed-indicator">
                        <strong>Velocidad de implementaci√≥n:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-medium" style="width: 70%;"></div>
                        </div>
                        <span>70%</span>
                    </div>
                    
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>‚úÖ Ventajas</h4>
                            <ul>
                                <li>M√°xima flexibilidad</li>
                                <li>Ecosistema robusto</li>
                                <li>Gratuito y open source</li>
                                <li>Muy escalable</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>‚ùå Limitaciones</h4>
                            <ul>
                                <li>Curva de aprendizaje</li>
                                <li>Requiere programaci√≥n</li>
                                <li>Setup m√°s complejo</li>
                                <li>Debugging necesario</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="comparison-card">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                        <div class="platform-logo r-logo">R</div>
                        <h3>R (Posit Cloud)</h3>
                    </div>
                    
                    <div class="speed-indicator">
                        <strong>Velocidad de implementaci√≥n:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-medium" style="width: 65%;"></div>
                        </div>
                        <span>65%</span>
                    </div>
                    
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>‚úÖ Ventajas</h4>
                            <ul>
                                <li>Estad√≠sticas avanzadas</li>
                                <li>Visualizaci√≥n superior</li>
                                <li>Tidyverse elegante</li>
                                <li>Comunidad acad√©mica</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>‚ùå Limitaciones</h4>
                            <ul>
                                <li>Sintaxis espec√≠fica</li>
                                <li>Memoria limitada</li>
                                <li>Menos vers√°til</li>
                                <li>Curva de aprendizaje</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- POWER BI SECTION CORREGIDA -->
        <div class="section">
            <h2>
                <div class="platform-logo powerbi-logo">PBI</div>
                LIMPIEZA EN POWER BI
            </h2>
            
            <div class="alert alert-info">
                <span style="font-size: 1.5rem;">üéØ</span>
                <div>
                    <strong>Filosof√≠a de Power BI:</strong> "Point, click, transform". Power BI prioriza la 
                    facilidad de uso y la intuici√≥n visual sobre el control program√°tico.
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Cargar el Dataset</div>
                    <div class="time-estimate">‚è±Ô∏è 3 min</div>
                </div>
                
                <ol>
                    <li><strong>Abrir Power BI Desktop</strong> (descargar desde powerbi.microsoft.com si no lo tienes)</li>
                    <li>Hacer clic en <strong>"Get Data"</strong> en la cinta de opciones</li>
                    <li>Seleccionar <strong>"Text/CSV"</strong> para archivos CSV o <strong>"Excel"</strong> para archivos Excel</li>
                    <li>Navegar y seleccionar tu archivo descargado</li>
                    <li>En la ventana de vista previa, hacer clic en <strong>"Transform Data"</strong></li>
                </ol>

                <div class="alert alert-warning">
                    <span style="font-size: 1.2rem;">‚ö†Ô∏è</span>
                    <strong>¬°NO hagas clic en "Load" directamente!</strong> Siempre ve a "Transform Data" para limpiar primero.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-completed">
                    <label for="pbi-completed">‚úÖ Dataset cargado en Power Query Editor</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Exploraci√≥n Inicial en Power Query</div>
                    <div class="time-estimate">‚è±Ô∏è 5 min</div>
                </div>
                
                <div style="background: rgba(52, 152, 219, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üîç Interface de Power Query Editor:</h4>
                    <ul>
                        <li><strong>Panel izquierdo:</strong> Lista de consultas (Queries)</li>
                        <li><strong>Centro:</strong> Vista previa de datos</li>
                        <li><strong>Panel derecho:</strong> Pasos aplicados (Applied Steps)</li>
                        <li><strong>Cinta superior:</strong> Herramientas de transformaci√≥n</li>
                    </ul>
                </div>

                <ol>
                    <li><strong>Examinar las columnas:</strong> Observa los tipos de datos en la parte superior de cada columna</li>
                    <li><strong>Ver estad√≠sticas:</strong> Clic en "View" ‚Üí "Column Quality" para ver % de errores/vac√≠os</li>
                    <li><strong>Activar perfil:</strong> Clic en "View" ‚Üí "Column Profile" para estad√≠sticas detalladas</li>
                    <li><strong>Verificar distribuci√≥n:</strong> Clic en "View" ‚Üí "Column Distribution" para ver frecuencias</li>
                </ol>

                <div class="alert alert-success">
                    <span style="font-size: 1.2rem;">üí°</span>
                    <strong>Ventaja de Power BI:</strong> Los indicadores visuales te muestran inmediatamente 
                    la calidad de cada columna sin escribir c√≥digo.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-exploration">
                    <label for="pbi-exploration">‚úÖ He explorado mi dataset y activado todas las vistas de calidad</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Limpieza B√°sica</div>
                    <div class="time-estimate">‚è±Ô∏è 10 min</div>
                </div>

                <h4>A) Eliminar duplicados:</h4>
                <ol>
                    <li>Seleccionar todas las columnas (Ctrl+A)</li>
                    <li>Ir a "Home" ‚Üí "Remove Rows" ‚Üí "Remove Duplicates"</li>
                    <li>Observar cu√°ntas filas se eliminaron en el mensaje</li>
                </ol>

                <h4>B) Limpiar nombres de columnas:</h4>
                <ol>
                    <li>Seleccionar todas las columnas</li>
                    <li>Clic derecho ‚Üí "Rename" o usar "Transform" ‚Üí "Format" ‚Üí "Trim" para espacios</li>
                    <li>Reemplazar espacios por guiones bajos si es necesario</li>
                </ol>

                <h4>C) Corregir tipos de datos:</h4>
                <ol>
                    <li>Hacer clic en el √≠cono de tipo de dato en cada columna</li>
                    <li>Seleccionar el tipo correcto (Text, Whole Number, Decimal, Date, etc.)</li>
                    <li>Si hay errores, Power BI te lo indicar√° visualmente</li>
                </ol>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-basic-cleaning">
                    <label for="pbi-basic-cleaning">‚úÖ Duplicados eliminados, columnas renombradas, tipos corregidos</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Manejar Valores Faltantes</div>
                    <div class="time-estimate">‚è±Ô∏è 8 min</div>
                </div>

                <div style="background: rgba(255, 193, 7, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üéØ Estrategias en Power BI:</h4>
                    <ul>
                        <li><strong>Remove Rows:</strong> Para eliminar filas con valores nulos</li>
                        <li><strong>Fill Down/Up:</strong> Para propagar valores</li>
                        <li><strong>Replace Values:</strong> Para reemplazar nulos con valores espec√≠ficos</li>
                    </ul>
                </div>

                <h4>Para columnas num√©ricas:</h4>
                <ol>
                    <li>Seleccionar la columna num√©rica</li>
                    <li>Ir a "Transform" ‚Üí "Replace Values"</li>
                    <li>En "Value to Find" dejar en blanco</li>
                    <li>En "Replace With" poner un valor como 0 o la media estimada</li>
                </ol>

                <h4>Para columnas de texto:</h4>
                <ol>
                    <li>Seleccionar la columna de texto</li>
                    <li>Ir a "Transform" ‚Üí "Replace Values"</li>
                    <li>Reemplazar valores en blanco con "Unknown" o "No Data"</li>
                </ol>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-missing-values">
                    <label for="pbi-missing-values">‚úÖ Valores faltantes tratados en columnas num√©ricas y de texto</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Detecci√≥n de Outliers en Power BI</div>
                    <div class="time-estimate">‚è±Ô∏è 6 min</div>
                </div>

                <div style="background: rgba(255, 193, 7, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üéØ Detecci√≥n de Outliers en Power BI:</h4>
                    <ul>
                        <li><strong>M√©todo Visual:</strong> Usar gr√°ficos de boxplot para identificar outliers</li>
                        <li><strong>Filtros avanzados:</strong> Crear filtros basados en percentiles</li>
                        <li><strong>Columnas calculadas:</strong> Usar DAX para marcar outliers</li>
                    </ul>
                </div>

                <h4>A) Crear columna calculada para detectar outliers:</h4>
                <ol>
                    <li>En Power Query, ir a "Add Column" ‚Üí "Custom Column"</li>
                    <li>Nombrar la columna: "Es_Outlier"</li>
                    <li>Usar f√≥rmula para detectar outliers basada en percentiles</li>
                    <li>Marcar valores que est√©n fuera del rango Q1-1.5*IQR a Q3+1.5*IQR</li>
                </ol>

                <h4>B) Aplicar transformaciones a outliers:</h4>
                <ol>
                    <li>Filtrar filas donde "Es_Outlier" = true</li>
                    <li>Decidir estrategia: eliminar, winsorizar o mantener</li>
                    <li>Aplicar "Replace Values" para corregir outliers extremos</li>
                    <li>Documentar decisiones en los "Applied Steps"</li>
                </ol>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-outliers">
                    <label for="pbi-outliers">‚úÖ Outliers detectados y tratados usando columnas calculadas</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Transformaciones de Datos</div>
                    <div class="time-estimate">‚è±Ô∏è 5 min</div>
                </div>

                <h4>A) Estandarizar formatos de texto:</h4>
                <ol>
                    <li>Seleccionar columnas de texto</li>
                    <li>Ir a "Transform" ‚Üí "Format" ‚Üí "UPPERCASE/lowercase/Proper Case"</li>
                    <li>Aplicar "Trim" para eliminar espacios extra</li>
                    <li>Usar "Clean" para caracteres no imprimibles</li>
                </ol>

                <h4>B) Crear columnas derivadas:</h4>
                <ol>
                    <li>Ir a "Add Column" ‚Üí "Custom Column"</li>
                    <li>Crear categor√≠as basadas en rangos num√©ricos</li>
                    <li>Generar flags booleanos para condiciones especiales</li>
                    <li>Calcular m√©tricas derivadas (ej: IMC, ratios, etc.)</li>
                </ol>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-transformations">
                    <label for="pbi-transformations">‚úÖ Transformaciones de formato y columnas derivadas aplicadas</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">7</div>
                    <div class="step-title">Validaci√≥n y Carga Final</div>
                    <div class="time-estimate">‚è±Ô∏è 4 min</div>
                </div>
                
                <ol>
                    <li><strong>Revisar pasos aplicados:</strong> En el panel "Applied Steps" verifica cada transformaci√≥n</li>
                    <li><strong>Verificar calidad:</strong> Aseg√∫rate de que "Column Quality" muestre 100% Valid</li>
                    <li><strong>Renombrar consulta:</strong> Clic derecho en "Query1" ‚Üí Rename ‚Üí "DatosLimpios"</li>
                    <li><strong>Cargar datos:</strong> Clic en "Home" ‚Üí "Close & Apply"</li>
                </ol>

                <div class="alert alert-success">
                    <span style="font-size: 1.2rem;">üéâ</span>
                    <strong>¬°Excelente!</strong> Tu dataset est√° limpio y listo para an√°lisis en Power BI.
                    Observa c√≥mo cada paso queda documentado autom√°ticamente.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="pbi-final">
                    <label for="pbi-final">‚úÖ Validaci√≥n completada y datos cargados exitosamente</label>
                </div>
            </div>
        </div>

        <!-- PYTHON SECTION -->
        <div class="section">
            <h2>
                <div class="platform-logo python-logo">üêç</div>
                LIMPIEZA EN PYTHON (GOOGLE COLAB)
            </h2>
            
            <div class="alert alert-info">
                <span style="font-size: 1.5rem;">üöÄ</span>
                <div>
                    <strong>Filosof√≠a de Python:</strong> "Explicit is better than implicit". Python te da control 
                    total sobre cada decisi√≥n de limpieza, pero requiere m√°s c√≥digo.
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Configurar Google Colab</div>
                    <div class="time-estimate">‚è±Ô∏è 2 min</div>
                </div>
                
                <ol>
                    <li>Ir a <strong>colab.research.google.com</strong></li>
                    <li>Crear un nuevo notebook: "Nuevo cuaderno"</li>
                    <li>Renombrar: "Limpieza_Datos_[TuNombre]"</li>
                    <li>Configurar runtime: Runtime ‚Üí Change runtime type ‚Üí Python 3</li>
                </ol>

                <div class="alert alert-warning">
                    <span style="font-size: 1.2rem;">‚ö°</span>
                    <strong>Ventaja de Colab:</strong> No necesitas instalar nada. Todo est√° en la nube y ya 
                    tiene las librer√≠as principales instaladas.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="colab-setup">
                    <label for="colab-setup">‚úÖ Google Colab configurado y notebook creado</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Cargar Dataset y Librer√≠as</div>
                    <div class="time-estimate">‚è±Ô∏è 5 min</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üêç</span>
                            <span>Celda 1: Importar librer√≠as esenciales</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 1: CONFIGURACI√ìN INICIAL Y LIBRER√çAS
# ===================================================================</span>

<span class="code-comment"># Importar librer√≠as esenciales para limpieza</span>
<span class="code-keyword">import</span> pandas <span class="code-keyword">as</span> pd
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np
<span class="code-keyword">import</span> matplotlib.pyplot <span class="code-keyword">as</span> plt
<span class="code-keyword">import</span> seaborn <span class="code-keyword">as</span> sns
<span class="code-keyword">from</span> datetime <span class="code-keyword">import</span> datetime
<span class="code-keyword">import</span> warnings

<span class="code-comment"># Configuraci√≥n para mejor visualizaci√≥n</span>
warnings.filterwarnings(<span class="code-string">'ignore'</span>)
plt.style.use(<span class="code-string">'seaborn-v0_8'</span>)
sns.set_palette(<span class="code-string">"husl"</span>)

<span class="code-comment"># Configurar pandas para mejor visualizaci√≥n</span>
pd.set_option(<span class="code-string">'display.max_columns'</span>, <span class="code-keyword">None</span>)
pd.set_option(<span class="code-string">'display.width'</span>, <span class="code-keyword">None</span>)
pd.set_option(<span class="code-string">'display.max_colwidth'</span>, <span class="code-keyword">50</span>)

<span class="code-comment"># Verificar instalaci√≥n exitosa</span>
<span class="code-keyword">print</span>(<span class="code-string">"‚úÖ Librer√≠as importadas exitosamente"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üìä Pandas versi√≥n: {pd.__version__}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üî¢ NumPy versi√≥n: {np.__version__}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üìà Matplotlib versi√≥n: {plt.matplotlib.__version__}"</span>)</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üìÅ</span>
                            <span>Celda 2: Cargar dataset</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 2: CARGA DE DATOS
# ===================================================================</span>

<span class="code-comment"># Opci√≥n 1: Subir archivo desde tu computadora</span>
<span class="code-keyword">from</span> google.colab <span class="code-keyword">import</span> files

<span class="code-keyword">print</span>(<span class="code-string">"üìÇ Selecciona tu archivo CSV desde tu computadora:"</span>)
uploaded = files.upload()

<span class="code-comment"># Obtener el nombre del archivo subido</span>
filename = list(uploaded.keys())[<span class="code-keyword">0</span>]
<span class="code-keyword">print</span>(<span class="code-string">f"üìÑ Archivo detectado: {filename}"</span>)

<span class="code-comment"># Cargar el dataset con manejo de errores</span>
<span class="code-keyword">try</span>:
    df = pd.read_csv(filename, encoding=<span class="code-string">'utf-8'</span>)
<span class="code-keyword">except</span> UnicodeDecodeError:
    <span class="code-keyword">print</span>(<span class="code-string">"‚ö†Ô∏è Problema de encoding, intentando con latin-1..."</span>)
    df = pd.read_csv(filename, encoding=<span class="code-string">'latin-1'</span>)

<span class="code-comment"># Informaci√≥n b√°sica de carga</span>
<span class="code-keyword">print</span>(<span class="code-string">f"‚úÖ Dataset cargado exitosamente"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üìè Dimensiones: {df.shape[0]:,} filas √ó {df.shape[1]} columnas"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üíæ Memoria usada: {df.memory_usage(deep=True).sum() / 1024**2:.2f} MB"</span>)

<span class="code-comment"># Opci√≥n 2: Cargar desde URL (comentado)
# df = pd.read_csv('https://tu-url-del-dataset.csv')</span></div>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="python-data-loaded">
                    <label for="python-data-loaded">‚úÖ Librer√≠as importadas y dataset cargado correctamente</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Exploraci√≥n Exhaustiva</div>
                    <div class="time-estimate">‚è±Ô∏è 8 min</div>
                </div>

                <div style="background: rgba(55, 118, 171, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üéØ Ventaja de Python:</h4>
                    <p>Python te permite crear un an√°lisis exploratorio completo con m√©tricas personalizadas 
                    que Power BI no puede generar autom√°ticamente.</p>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üîç</span>
                            <span>Celda 3: An√°lisis exploratorio completo</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 3: AN√ÅLISIS EXPLORATORIO DE DATOS (EDA)
# ===================================================================</span>

<span class="code-comment"># Informaci√≥n general del dataset</span>
<span class="code-keyword">print</span>(<span class="code-string">"="*50</span>)
<span class="code-keyword">print</span>(<span class="code-string">"üìä REPORTE DE CALIDAD DE DATOS"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"="*50</span>)

<span class="code-comment"># 1. INFORMACI√ìN B√ÅSICA</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüî¢ INFORMACI√ìN B√ÅSICA:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"Filas: {df.shape[0]:,}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"Columnas: {df.shape[1]}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"Memoria total: {df.memory_usage(deep=True).sum() / 1024**2:.2f} MB"</span>)

<span class="code-comment"># 2. TIPOS DE DATOS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìã TIPOS DE DATOS:"</span>)
<span class="code-keyword">print</span>(df.dtypes.value_counts())

<span class="code-comment"># 3. AN√ÅLISIS DE VALORES FALTANTES</span>
<span class="code-keyword">print</span>(<span class="code-string">"\n‚ùì VALORES FALTANTES:"</span>)
missing_data = df.isnull().sum()
missing_percent = <span class="code-keyword">100</span> * missing_data / len(df)
missing_table = pd.DataFrame({
    <span class="code-string">'Columna'</span>: missing_data.index,
    <span class="code-string">'Faltantes'</span>: missing_data.values,
    <span class="code-string">'Porcentaje'</span>: missing_percent.values
}).sort_values(<span class="code-string">'Porcentaje'</span>, ascending=<span class="code-keyword">False</span>)

<span class="code-comment"># Mostrar solo columnas con valores faltantes</span>
missing_table_filtered = missing_table[missing_table[<span class="code-string">'Faltantes'</span>] > <span class="code-keyword">0</span>]
<span class="code-keyword">if</span> len(missing_table_filtered) > <span class="code-keyword">0</span>:
    <span class="code-keyword">print</span>(missing_table_filtered.to_string(index=<span class="code-keyword">False</span>))
<span class="code-keyword">else</span>:
    <span class="code-keyword">print</span>(<span class="code-string">"‚úÖ No hay valores faltantes en el dataset"</span>)

<span class="code-comment"># 4. DUPLICADOS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüîÑ DUPLICADOS:"</span>)
duplicates = df.duplicated().sum()
<span class="code-keyword">print</span>(<span class="code-string">f"Filas duplicadas: {duplicates:,} ({100*duplicates/len(df):.2f}%)"</span>)

<span class="code-comment"># 5. ESTAD√çSTICAS DESCRIPTIVAS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìä ESTAD√çSTICAS DESCRIPTIVAS:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"\nColumnas num√©ricas:"</span>)
<span class="code-keyword">print</span>(df.describe())

<span class="code-keyword">print</span>(<span class="code-string">"\nColumnas categ√≥ricas:"</span>)
<span class="code-keyword">print</span>(df.describe(include=[<span class="code-string">'object'</span>]))</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üìà</span>
                            <span>Celda 4: Visualizaci√≥n de problemas</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 4: VISUALIZACI√ìN DE CALIDAD DE DATOS
# ===================================================================</span>

<span class="code-comment"># Crear visualizaciones de calidad de datos</span>
fig, axes = plt.subplots(<span class="code-keyword">2</span>, <span class="code-keyword">2</span>, figsize=(<span class="code-keyword">15</span>, <span class="code-keyword">10</span>))
fig.suptitle(<span class="code-string">'üìä DIAGN√ìSTICO DE CALIDAD DE DATOS'</span>, fontsize=<span class="code-keyword">16</span>, fontweight=<span class="code-string">'bold'</span>)

<span class="code-comment"># 1. Gr√°fico de valores faltantes</span>
missing_data = df.isnull().sum()
missing_data = missing_data[missing_data > <span class="code-keyword">0</span>].sort_values(ascending=<span class="code-keyword">True</span>)

<span class="code-keyword">if</span> len(missing_data) > <span class="code-keyword">0</span>:
    missing_data.plot(kind=<span class="code-string">'barh'</span>, ax=axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>], color=<span class="code-string">'coral'</span>)
    axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>].set_title(<span class="code-string">'üîç Valores Faltantes por Columna'</span>)
    axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>].set_xlabel(<span class="code-string">'Cantidad de Valores Faltantes'</span>)
<span class="code-keyword">else</span>:
    axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>].text(<span class="code-keyword">0.5</span>, <span class="code-keyword">0.5</span>, <span class="code-string">'‚úÖ Sin valores faltantes'</span>, 
                   ha=<span class="code-string">'center'</span>, va=<span class="code-string">'center'</span>, transform=axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>].transAxes, fontsize=<span class="code-keyword">12</span>)
    axes[<span class="code-keyword">0</span>,<span class="code-keyword">0</span>].set_title(<span class="code-string">'üîç Valores Faltantes por Columna'</span>)

<span class="code-comment"># 2. Distribuci√≥n de tipos de datos</span>
type_counts = df.dtypes.value_counts()
axes[<span class="code-keyword">0</span>,<span class="code-keyword">1</span>].pie(type_counts.values, labels=type_counts.index, autopct=<span class="code-string">'%1.1f%%'</span>, startangle=<span class="code-keyword">90</span>)
axes[<span class="code-keyword">0</span>,<span class="code-keyword">1</span>].set_title(<span class="code-string">'üìä Distribuci√≥n de Tipos de Datos'</span>)

<span class="code-comment"># 3. Heatmap de correlaci√≥n para columnas num√©ricas</span>
numeric_cols = df.select_dtypes(include=[np.number]).columns
<span class="code-keyword">if</span> len(numeric_cols) > <span class="code-keyword">1</span>:
    correlation_matrix = df[numeric_cols].corr()
    sns.heatmap(correlation_matrix, annot=<span class="code-keyword">True</span>, cmap=<span class="code-string">'coolwarm'</span>, 
                center=<span class="code-keyword">0</span>, ax=axes[<span class="code-keyword">1</span>,<span class="code-keyword">0</span>], cbar_kws={<span class="code-string">'shrink'</span>: <span class="code-keyword">0.8</span>})
    axes[<span class="code-keyword">1</span>,<span class="code-keyword">0</span>].set_title(<span class="code-string">'üî• Mapa de Correlaci√≥n'</span>)
<span class="code-keyword">else</span>:
    axes[<span class="code-keyword">1</span>,<span class="code-keyword">0</span>].text(<span class="code-keyword">0.5</span>, <span class="code-keyword">0.5</span>, <span class="code-string">'Pocas columnas\nnum√©ricas'</span>, 
                   ha=<span class="code-string">'center'</span>, va=<span class="code-string">'center'</span>, transform=axes[<span class="code-keyword">1</span>,<span class="code-keyword">0</span>].transAxes, fontsize=<span class="code-keyword">12</span>)
    axes[<span class="code-keyword">1</span>,<span class="code-keyword">0</span>].set_title(<span class="code-string">'üî• Mapa de Correlaci√≥n'</span>)

<span class="code-comment"># 4. Distribuci√≥n de duplicados</span>
duplicate_info = [<span class="code-string">'√önicos'</span>, <span class="code-string">'Duplicados'</span>]
duplicate_counts = [len(df) - df.duplicated().sum(), df.duplicated().sum()]
colors = [<span class="code-string">'lightgreen'</span>, <span class="code-string">'lightcoral'</span>]
axes[<span class="code-keyword">1</span>,<span class="code-keyword">1</span>].pie(duplicate_counts, labels=duplicate_info, autopct=<span class="code-string">'%1.1f%%'</span>, 
              colors=colors, startangle=<span class="code-keyword">90</span>)
axes[<span class="code-keyword">1</span>,<span class="code-keyword">1</span>].set_title(<span class="code-string">'üîÑ Distribuci√≥n de Duplicados'</span>)

plt.tight_layout()
plt.show()

<span class="code-keyword">print</span>(<span class="code-string">"üìä Visualizaciones de diagn√≥stico generadas exitosamente"</span>)</div>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="python-exploration">
                    <label for="python-exploration">‚úÖ Exploraci√≥n completa realizada con estad√≠sticas y visualizaciones</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Limpieza Sistem√°tica</div>
                    <div class="time-estimate">‚è±Ô∏è 12 min</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üßπ</span>
                            <span>Celda 5: Crear copia y limpiar b√°sico</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 5: LIMPIEZA B√ÅSICA DE DATOS
# ===================================================================</span>

<span class="code-comment"># Crear una copia para mantener los datos originales</span>
df_original = df.copy()
df_clean = df.copy()

<span class="code-keyword">print</span>(<span class="code-string">"üìã INICIANDO PROCESO DE LIMPIEZA..."</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"üìä Dataset original: {df_clean.shape}"</span>)

<span class="code-comment"># 1. ELIMINAR DUPLICADOS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüîÑ ELIMINANDO DUPLICADOS:"</span>)
initial_rows = len(df_clean)
df_clean = df_clean.drop_duplicates()
duplicates_removed = initial_rows - len(df_clean)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Duplicados eliminados: {duplicates_removed:,}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Filas restantes: {len(df_clean):,}"</span>)

<span class="code-comment"># 2. LIMPIAR NOMBRES DE COLUMNAS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìù ESTANDARIZANDO NOMBRES DE COLUMNAS:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"   Nombres originales:"</span>, list(df_clean.columns[:5]), <span class="code-string">"..."</span>)

df_clean.columns = (df_clean.columns
                   .str.strip()           <span class="code-comment"># Quitar espacios al inicio/final</span>
                   .str.lower()           <span class="code-comment"># Convertir a min√∫sculas</span>
                   .str.replace(<span class="code-string">' '</span>, <span class="code-string">'_'</span>)     <span class="code-comment"># Espacios por guiones bajos</span>
                   .str.replace(<span class="code-string">'[^a-zA-Z0-9_]'</span>, <span class="code-string">''</span>, regex=<span class="code-keyword">True</span>)) <span class="code-comment"># Solo alfanum√©ricos</span>

<span class="code-keyword">print</span>(<span class="code-string">"   Nombres estandarizados:"</span>, list(df_clean.columns[:5]), <span class="code-string">"..."</span>)

<span class="code-comment"># 3. VERIFICAR MEJORAS B√ÅSICAS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\n‚úÖ LIMPIEZA B√ÅSICA COMPLETADA:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Dimensiones: {df_clean.shape}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Duplicados restantes: {df_clean.duplicated().sum()}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Columnas renombradas: {len(df_clean.columns)}"</span>)</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üîß</span>
                            <span>Celda 6: Manejo inteligente de valores faltantes</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 6: TRATAMIENTO INTELIGENTE DE VALORES FALTANTES
# ===================================================================</span>

<span class="code-keyword">print</span>(<span class="code-string">"üîß MANEJO DE VALORES FALTANTES:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"Total valores faltantes iniciales: {df_clean.isnull().sum().sum():,}"</span>)

<span class="code-comment"># ESTRATEGIA 1: COLUMNAS NUM√âRICAS - Usar mediana (m√°s robusta que media)</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìä PROCESANDO COLUMNAS NUM√âRICAS:"</span>)
numeric_cols = df_clean.select_dtypes(include=[np.number]).columns

<span class="code-keyword">for</span> col <span class="code-keyword">in</span> numeric_cols:
    missing_count = df_clean[col].isnull().sum()
    <span class="code-keyword">if</span> missing_count > <span class="code-keyword">0</span>:
        <span class="code-comment"># Calcular estad√≠sticas antes de imputar</span>
        median_value = df_clean[col].median()
        mean_value = df_clean[col].mean()
        
        <span class="code-comment"># Usar mediana para imputaci√≥n (m√°s robusta a outliers)</span>
        df_clean[col] = df_clean[col].fillna(median_value)
        
        <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ {col}:"</span>)
        <span class="code-keyword">print</span>(<span class="code-string">f"     - Valores faltantes: {missing_count:,} ({100*missing_count/len(df_clean):.1f}%)"</span>)
        <span class="code-keyword">print</span>(<span class="code-string">f"     - Imputado con mediana: {median_value:.2f}"</span>)
        <span class="code-keyword">print</span>(<span class="code-string">f"     - (Media era: {mean_value:.2f})"</span>)

<span class="code-comment"># ESTRATEGIA 2: COLUMNAS CATEG√ìRICAS - Usar moda o 'Unknown'</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìù PROCESANDO COLUMNAS CATEG√ìRICAS:"</span>)
categorical_cols = df_clean.select_dtypes(include=[<span class="code-string">'object'</span>]).columns

<span class="code-keyword">for</span> col <span class="code-keyword">in</span> categorical_cols:
    missing_count = df_clean[col].isnull().sum()
    <span class="code-keyword">if</span> missing_count > <span class="code-keyword">0</span>:
        <span class="code-comment"># Determinar el valor m√°s frecuente</span>
        mode_values = df_clean[col].mode()
        
        <span class="code-keyword">if</span> len(mode_values) > <span class="code-keyword">0</span> <span class="code-keyword">and</span> pd.notna(mode_values[<span class="code-keyword">0</span>]):
            fill_value = mode_values[<span class="code-keyword">0</span>]
            strategy = <span class="code-string">"moda"</span>
        <span class="code-keyword">else</span>:
            fill_value = <span class="code-string">'Unknown'</span>
            strategy = <span class="code-string">"valor por defecto"</span>
        
        df_clean[col] = df_clean[col].fillna(fill_value)
        
        <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ {col}:"</span>)
        <span class="code-keyword">print</span>(<span class="code-string">f"     - Valores faltantes: {missing_count:,} ({100*missing_count/len(df_clean):.1f}%)"</span>)
        <span class="code-keyword">print</span>(<span class="code-string">f"     - Imputado con {strategy}: '{fill_value}'"</span>)

<span class="code-comment"># ESTRATEGIA 3: COLUMNAS DE FECHA - Tratamiento especial</span>
date_cols = df_clean.select_dtypes(include=[<span class="code-string">'datetime64'</span>]).columns
<span class="code-keyword">if</span> len(date_cols) > <span class="code-keyword">0</span>:
    <span class="code-keyword">print</span>(<span class="code-string">"\nüìÖ PROCESANDO COLUMNAS DE FECHA:"</span>)
    <span class="code-keyword">for</span> col <span class="code-keyword">in</span> date_cols:
        missing_count = df_clean[col].isnull().sum()
        <span class="code-keyword">if</span> missing_count > <span class="code-keyword">0</span>:
            <span class="code-comment"># Usar la fecha m√°s frecuente o una fecha por defecto</span>
            mode_date = df_clean[col].mode()
            <span class="code-keyword">if</span> <span class="code-keyword">not</span> mode_date.empty:
                fill_value = mode_date[<span class="code-keyword">0</span>]
            <span class="code-keyword">else</span>:
                fill_value = pd.to_datetime(<span class="code-string">'1900-01-01'</span>)
            
            df_clean[col] = df_clean[col].fillna(fill_value)
            <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ {col}: {missing_count:,} valores ‚Üí {fill_value}"</span>)

<span class="code-comment"># VERIFICACI√ìN FINAL</span>
remaining_missing = df_clean.isnull().sum().sum()
<span class="code-keyword">print</span>(<span class="code-string">f"\n‚úÖ RESULTADOS DEL TRATAMIENTO:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Valores faltantes restantes: {remaining_missing:,}"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Tasa de completitud: {100*(1-remaining_missing/df_clean.size):.2f}%"</span>)</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üéØ</span>
                            <span>Celda 7: Detecci√≥n y tratamiento de outliers</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 7: DETECCI√ìN Y TRATAMIENTO DE OUTLIERS
# ===================================================================</span>

<span class="code-keyword">def</span> detect_outliers_iqr(df, column):
    <span class="code-string">"""
    Detecta outliers usando el m√©todo IQR (Rango Intercuart√≠lico)
    Retorna: outliers, l√≠mite_inferior, l√≠mite_superior
    """</span>
    Q1 = df[column].quantile(<span class="code-keyword">0.25</span>)
    Q3 = df[column].quantile(<span class="code-keyword">0.75</span>)
    IQR = Q3 - Q1
    
    <span class="code-comment"># L√≠mites para detectar outliers</span>
    lower_bound = Q1 - <span class="code-keyword">1.5</span> * IQR
    upper_bound = Q3 + <span class="code-keyword">1.5</span> * IQR
    
    <span class="code-comment"># Identificar outliers</span>
    outliers = df[(df[column] < lower_bound) | (df[column] > upper_bound)]
    
    <span class="code-keyword">return</span> outliers, lower_bound, upper_bound

<span class="code-keyword">print</span>(<span class="code-string">"üéØ AN√ÅLISIS DE OUTLIERS:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"="*50</span>)

outliers_summary = []
numeric_cols = df_clean.select_dtypes(include=[np.number]).columns

<span class="code-keyword">for</span> col <span class="code-keyword">in</span> numeric_cols:
    <span class="code-keyword">print</span>(<span class="code-string">f"\nüìä ANALIZANDO: {col}"</span>)
    
    <span class="code-comment"># Detectar outliers</span>
    outliers, lower, upper = detect_outliers_iqr(df_clean, col)
    outlier_count = len(outliers)
    outlier_percentage = (outlier_count / len(df_clean)) * <span class="code-keyword">100</span>
    
    <span class="code-comment"># Estad√≠sticas de la columna</span>
    col_stats = {
        <span class="code-string">'Columna'</span>: col,
        <span class="code-string">'Outliers'</span>: outlier_count,
        <span class="code-string">'Porcentaje'</span>: <span class="code-string">f"{outlier_percentage:.2f}%"</span>,
        <span class="code-string">'L√≠mite_Inferior'</span>: <span class="code-string">f"{lower:.2f}"</span>,
        <span class="code-string">'L√≠mite_Superior'</span>: <span class="code-string">f"{upper:.2f}"</span>,
        <span class="code-string">'Min_Actual'</span>: <span class="code-string">f"{df_clean[col].min():.2f}"</span>,
        <span class="code-string">'Max_Actual'</span>: <span class="code-string">f"{df_clean[col].max():.2f}"</span>
    }
    outliers_summary.append(col_stats)
    
    <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Outliers encontrados: {outlier_count:,} ({outlier_percentage:.2f}%)"</span>)
    <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Rango normal: [{lower:.2f}, {upper:.2f}]"</span>)
    <span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Rango actual: [{df_clean[col].min():.2f}, {df_clean[col].max():.2f}]"</span>)
    
    <span class="code-comment"># ESTRATEGIA DE TRATAMIENTO</span>
    <span class="code-keyword">if</span> outlier_percentage > <span class="code-keyword">5</span>:  <span class="code-comment"># Si hay muchos outliers (>5%)</span>
        <span class="code-keyword">print</span>(<span class="code-string">f"   üîß APLICANDO WINSORIZACI√ìN (muchos outliers)"</span>)
        
        <span class="code-comment"># Winsorizaci√≥n: cambiar outliers por los l√≠mites</span>
        original_outliers = outlier_count
        df_clean[col] = np.where(df_clean[col] < lower, lower, df_clean[col])
        df_clean[col] = np.where(df_clean[col] > upper, upper, df_clean[col])
        
        <span class="code-keyword">print</span>(<span class="code-string">f"   ‚úÖ {original_outliers:,} valores winsurizados"</span>)
        
    <span class="code-keyword">elif</span> outlier_percentage > <span class="code-keyword">1</span>:  <span class="code-comment"># Outliers moderados (1-5%)</span>
        <span class="code-keyword">print</span>(<span class="code-string">f"   ‚ö†Ô∏è OUTLIERS MODERADOS - mantenidos para revisi√≥n"</span>)
        
    <span class="code-keyword">else</span>:  <span class="code-comment"># Pocos outliers (<1%)</span>
        <span class="code-keyword">print</span>(<span class="code-string">f"   ‚úÖ OUTLIERS M√çNIMOS - mantenidos (podr√≠an ser valores v√°lidos)"</span>)

<span class="code-comment"># MOSTRAR RESUMEN DE OUTLIERS</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìã RESUMEN DE AN√ÅLISIS DE OUTLIERS:"</span>)
outliers_df = pd.DataFrame(outliers_summary)
<span class="code-keyword">print</span>(outliers_df.to_string(index=<span class="code-keyword">False</span>))</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>‚úÖ</span>
                            <span>Celda 8: Validaci√≥n y comparaci√≥n antes/despu√©s</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># ===================================================================
# BLOQUE 8: VALIDACI√ìN FINAL Y REPORTE DE RESULTADOS
# ===================================================================</span>

<span class="code-keyword">print</span>(<span class="code-string">"="*60</span>)
<span class="code-keyword">print</span>(<span class="code-string">"üìä REPORTE FINAL DE LIMPIEZA DE DATOS"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"="*60</span>)

<span class="code-comment"># 1. COMPARACI√ìN DE DIMENSIONES</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüìè DIMENSIONES:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Antes:   {df_original.shape[0]:,} filas √ó {df_original.shape[1]} columnas"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Despu√©s: {df_clean.shape[0]:,} filas √ó {df_clean.shape[1]} columnas"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Cambio:  {df_clean.shape[0] - df_original.shape[0]:,} filas"</span>)

<span class="code-comment"># 2. COMPARACI√ìN DE VALORES FALTANTES</span>
missing_before = df_original.isnull().sum().sum()
missing_after = df_clean.isnull().sum().sum()
<span class="code-keyword">print</span>(<span class="code-string">"\n‚ùì VALORES FALTANTES:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Antes:   {missing_before:,} valores faltantes"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Despu√©s: {missing_after:,} valores faltantes"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Mejor√≠a: {missing_before - missing_after:,} valores corregidos"</span>)

<span class="code-comment"># 3. COMPARACI√ìN DE DUPLICADOS</span>
dup_before = df_original.duplicated().sum()
dup_after = df_clean.duplicated().sum()
<span class="code-keyword">print</span>(<span class="code-string">"\nüîÑ DUPLICADOS:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Antes:   {dup_before:,} filas duplicadas"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Despu√©s: {dup_after:,} filas duplicadas"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Eliminadas: {dup_before - dup_after:,} filas duplicadas"</span>)

<span class="code-comment"># 4. COMPARACI√ìN DE MEMORIA</span>
memory_before = df_original.memory_usage(deep=<span class="code-keyword">True</span>).sum() / <span class="code-keyword">1024</span>**<span class="code-keyword">2</span>
memory_after = df_clean.memory_usage(deep=<span class="code-keyword">True</span>).sum() / <span class="code-keyword">1024</span>**<span class="code-keyword">2</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüíæ USO DE MEMORIA:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Antes:   {memory_before:.2f} MB"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Despu√©s: {memory_after:.2f} MB"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Ahorro:  {memory_before - memory_after:.2f} MB ({100*(memory_before-memory_after)/memory_before:.1f}%)"</span>)

<span class="code-comment"># 5. CALIDAD DE DATOS FINAL</span>
<span class="code-keyword">print</span>(<span class="code-string">"\nüéØ CALIDAD FINAL DE DATOS:"</span>)
total_cells = df_clean.shape[<span class="code-keyword">0</span>] * df_clean.shape[<span class="code-keyword">1</span>]
completeness = <span class="code-keyword">100</span> * (<span class="code-keyword">1</span> - missing_after / total_cells)
uniqueness = <span class="code-keyword">100</span> * (<span class="code-keyword">1</span> - dup_after / df_clean.shape[<span class="code-keyword">0</span>])

<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Completitud: {completeness:.2f}%"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Unicidad: {uniqueness:.2f}%"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Consistencia: ‚úÖ Nombres estandarizados"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   ‚Ä¢ Validez: ‚úÖ Tipos de datos correctos"</span>)

<span class="code-comment"># 6. GUARDAR DATASET LIMPIO</span>
filename_clean = <span class="code-string">'dataset_limpio_python.csv'</span>
df_clean.to_csv(filename_clean, index=<span class="code-keyword">False</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"\nüíæ EXPORTACI√ìN:"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Dataset limpio guardado como: '{filename_clean}'"</span>)
<span class="code-keyword">print</span>(<span class="code-string">f"   Tama√±o del archivo: {round(pd.read_csv(filename_clean).memory_usage(deep=True).sum()/1024**2, 2)} MB"</span>)

<span class="code-comment"># 7. CREAR REPORTE RESUMIDO</span>
summary_report = {
    <span class="code-string">'M√©trica'</span>: [<span class="code-string">'Filas'</span>, <span class="code-string">'Columnas'</span>, <span class="code-string">'Valores Faltantes'</span>, <span class="code-string">'Duplicados'</span>, <span class="code-string">'Memoria (MB)'</span>],
    <span class="code-string">'Antes'</span>: [df_original.shape[<span class="code-keyword">0</span>], df_original.shape[<span class="code-keyword">1</span>], missing_before, dup_before, round(memory_before, <span class="code-keyword">2</span>)],
    <span class="code-string">'Despu√©s'</span>: [df_clean.shape[<span class="code-keyword">0</span>], df_clean.shape[<span class="code-keyword">1</span>], missing_after, dup_after, round(memory_after, <span class="code-keyword">2</span>)],
    <span class="code-string">'Mejora'</span>: [
        df_clean.shape[<span class="code-keyword">0</span>] - df_original.shape[<span class="code-keyword">0</span>],
        <span class="code-keyword">0</span>,  <span class="code-comment"># columnas no cambian</span>
        missing_before - missing_after,
        dup_before - dup_after,
        round(memory_before - memory_after, <span class="code-keyword">2</span>)
    ]
}

summary_df = pd.DataFrame(summary_report)
<span class="code-keyword">print</span>(<span class="code-string">f"\nüìä TABLA RESUMEN:"</span>)
<span class="code-keyword">print</span>(summary_df.to_string(index=<span class="code-keyword">False</span>))

<span class="code-keyword">print</span>(<span class="code-string">"\nüéâ ¬°PROCESO DE LIMPIEZA COMPLETADO EXITOSAMENTE!"</span>)
<span class="code-keyword">print</span>(<span class="code-string">"üìã Tu dataset est√° listo para an√°lisis y modelado."</span>)</div>
                </div>

                <div class="alert alert-success">
                    <span style="font-size: 1.2rem;">üöÄ</span>
                    <strong>Ventaja de Python:</strong> Tienes control total sobre cada decisi√≥n y puedes 
                    crear reportes personalizados imposibles en interfaces gr√°ficas.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="python-completed">
                    <label for="python-completed">‚úÖ Validaci√≥n completa y dataset limpio exportado</label>
                </div>
            </div>
        </div>

        <!-- R SECTION -->
        <div class="section">
            <h2>
                <div class="platform-logo r-logo">R</div>
                LIMPIEZA EN R (POSIT CLOUD)
            </h2>
            
            <div class="alert alert-info">
                <span style="font-size: 1.5rem;">üìä</span>
                <div>
                    <strong>Filosof√≠a de R:</strong> "Statistics first, everything else second". R est√° optimizado 
                    para an√°lisis estad√≠stico y visualizaci√≥n elegante de datos.
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Configurar Posit Cloud</div>
                    <div class="time-estimate">‚è±Ô∏è 3 min</div>
                </div>
                
                <ol>
                    <li>Ir a <strong>posit.cloud</strong> (anteriormente RStudio Cloud)</li>
                    <li>Crear cuenta gratuita si no tienes una</li>
                    <li>Crear nuevo proyecto: "New Project" ‚Üí "New RStudio Project"</li>
                    <li>Nombrar el proyecto: "Limpieza_Datos_[TuNombre]"</li>
                </ol>

                <div style="background: rgba(22, 92, 170, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üéØ Interface de RStudio:</h4>
                    <ul>
                        <li><strong>Superior izquierda:</strong> Editor de scripts</li>
                        <li><strong>Superior derecha:</strong> Environment y History</li>
                        <li><strong>Inferior izquierda:</strong> Consola R</li>
                        <li><strong>Inferior derecha:</strong> Files, Plots, Packages, Help</li>
                    </ul>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-setup">
                    <label for="r-setup">‚úÖ Posit Cloud configurado y proyecto R creado</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Instalar y Cargar Librer√≠as</div>
                    <div class="time-estimate">‚è±Ô∏è 4 min</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üì¶</span>
                            <span>Script R: Instalaci√≥n y carga de librer√≠as</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># Instalar librer√≠as necesarias (solo primera vez)</span>
install.packages(c(<span class="code-string">"dplyr"</span>, <span class="code-string">"tidyr"</span>, <span class="code-string">"readr"</span>, <span class="code-string">"ggplot2"</span>, 
                   <span class="code-string">"VIM"</span>, <span class="code-string">"mice"</span>, <span class="code-string">"corrplot"</span>, <span class="code-string">"lubridate"</span>, 
                   <span class="code-string">"stringr"</span>, <span class="code-string">"forcats"</span>))

<span class="code-comment"># Cargar librer√≠as esenciales</span>
library(dplyr)      <span class="code-comment"># Manipulaci√≥n de datos</span>
library(tidyr)      <span class="code-comment"># Reorganizaci√≥n de datos</span>
library(readr)      <span class="code-comment"># Lectura de datos</span>
library(ggplot2)    <span class="code-comment"># Visualizaci√≥n elegante</span>
library(VIM)        <span class="code-comment"># Visualizaci√≥n de valores faltantes</span>
library(mice)       <span class="code-comment"># Imputaci√≥n m√∫ltiple</span>
library(corrplot)   <span class="code-comment"># Matrices de correlaci√≥n</span>
library(lubridate)  <span class="code-comment"># Manejo de fechas</span>
library(stringr)    <span class="code-comment"># Manipulaci√≥n de strings</span>
library(forcats)    <span class="code-comment"># Manejo de factores</span>

<span class="code-comment"># Verificar instalaci√≥n</span>
cat(<span class="code-string">"‚úÖ Librer√≠as cargadas exitosamente\n"</span>)
cat(<span class="code-string">"üìä Tidyverse ecosystem listo\n"</span>)
cat(<span class="code-string">"üî¢ R versi√≥n:"</span>, R.version.string, <span class="code-string">"\n"</span>)</div>
                </div>

                <div class="alert alert-warning">
                    <span style="font-size: 1.2rem;">‚ö°</span>
                    <strong>Ventaja de R:</strong> El ecosistema Tidyverse hace que la manipulaci√≥n de datos 
                    sea muy legible y expresiva, casi como escribir en ingl√©s.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-libraries">
                    <label for="r-libraries">‚úÖ Librer√≠as instaladas y cargadas correctamente</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Cargar y Explorar Dataset</div>
                    <div class="time-estimate">‚è±Ô∏è 6 min</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üìÅ</span>
                            <span>Cargar dataset</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># Subir archivo (usar Files panel en RStudio)</span>
<span class="code-comment"># Opci√≥n 1: Upload button en Files panel, luego:</span>
df <- read_csv(<span class="code-string">"tu_archivo.csv"</span>)

<span class="code-comment"># Opci√≥n 2: Desde URL</span>
<span class="code-comment"># df <- read_csv("https://tu-url-del-dataset.csv")</span>

<span class="code-comment"># Informaci√≥n b√°sica del dataset</span>
cat(<span class="code-string">"üìä INFORMACI√ìN B√ÅSICA DEL DATASET\n"</span>)
cat(<span class="code-string">"==================================\n"</span>)
cat(<span class="code-string">"Dimensiones:"</span>, dim(df), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Filas:"</span>, nrow(df), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Columnas:"</span>, ncol(df), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Tama√±o en memoria:"</span>, format(object.size(df), units = <span class="code-string">"MB"</span>), <span class="code-string">"\n"</span>)

<span class="code-comment"># Estructura del dataset</span>
cat(<span class="code-string">"\nüìã ESTRUCTURA DE DATOS:\n"</span>)
str(df)

<span class="code-comment"># Primeras filas</span>
cat(<span class="code-string">"\nüëÄ PRIMERAS 6 FILAS:\n"</span>)
head(df)</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üîç</span>
                            <span>An√°lisis de calidad de datos</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># An√°lisis estad√≠stico completo</span>
cat(<span class="code-string">"\nüìä RESUMEN ESTAD√çSTICO:\n"</span>)
summary(df)

<span class="code-comment"># Valores faltantes con visualizaci√≥n elegante</span>
cat(<span class="code-string">"\n‚ùì AN√ÅLISIS DE VALORES FALTANTES:\n"</span>)
missing_data <- df %>%
  summarise_all(~sum(is.na(.))) %>%
  gather(key = <span class="code-string">"variable"</span>, value = <span class="code-string">"missing_count"</span>) %>%
  mutate(missing_percent = round(<span class="code-keyword">100</span> * missing_count / nrow(df), <span class="code-keyword">2</span>)) %>%
  arrange(desc(missing_count))

print(missing_data)

<span class="code-comment"># Visualizaci√≥n de patrones de datos faltantes</span>
<span class="code-keyword">if</span>(sum(missing_data$missing_count) > <span class="code-keyword">0</span>) {
  cat(<span class="code-string">"\nüìà VISUALIZACI√ìN DE PATRONES FALTANTES:\n"</span>)
  VIM::aggr(df, col = c(<span class="code-string">'navyblue'</span>,<span class="code-string">'red'</span>), 
            numbers = <span class="code-keyword">TRUE</span>, sortVars = <span class="code-keyword">TRUE</span>,
            main = <span class="code-string">"Patr√≥n de Valores Faltantes"</span>)
}

<span class="code-comment"># Duplicados</span>
duplicates <- sum(duplicated(df))
cat(<span class="code-string">"\nüîÑ DUPLICADOS ENCONTRADOS:"</span>, duplicates, <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Porcentaje de duplicados:"</span>, round(<span class="code-keyword">100</span> * duplicates / nrow(df), <span class="code-keyword">2</span>), <span class="code-string">"%\n"</span>)</div>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-exploration">
                    <label for="r-exploration">‚úÖ Dataset cargado y an√°lisis exploratorio completado con VIM</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Limpieza con Tidyverse</div>
                    <div class="time-estimate">‚è±Ô∏è 10 min</div>
                </div>

                <div style="background: rgba(22, 92, 170, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üöÄ Filosof√≠a Tidyverse:</h4>
                    <p>El pipe operator (%>%) permite crear "pipelines" de transformaci√≥n muy legibles. 
                    Cada funci√≥n hace una cosa y la hace bien.</p>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üßπ</span>
                            <span>Pipeline de limpieza con dplyr</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># Pipeline de limpieza completo usando tidyverse</span>
df_clean <- df %>%
  <span class="code-comment"># 1. Eliminar duplicados</span>
  distinct() %>%
  
  <span class="code-comment"># 2. Limpiar nombres de columnas</span>
  rename_all(~ gsub(<span class="code-string">" "</span>, <span class="code-string">"_"</span>, tolower(trimws(.)))) %>%
  
  <span class="code-comment"># 3. Convertir tipos de datos apropiados</span>
  mutate_if(is.character, as.factor) %>%  <span class="code-comment"># Caracteres a factores</span>
  
  <span class="code-comment"># 4. Manejo inteligente de outliers usando IQR</span>
  mutate_if(is.numeric, ~ ifelse(
    abs(. - median(., na.rm = <span class="code-keyword">TRUE</span>)) > <span class="code-keyword">3</span> * IQR(., na.rm = <span class="code-keyword">TRUE</span>),
    median(., na.rm = <span class="code-keyword">TRUE</span>), 
    .
  )) %>%
  
  <span class="code-comment"># 5. Imputaci√≥n de valores faltantes por tipo</span>
  mutate_if(is.numeric, ~ ifelse(is.na(.), median(., na.rm = <span class="code-keyword">TRUE</span>), .)) %>%
  mutate_if(is.factor, ~ ifelse(is.na(.), 
                               names(sort(table(.), decreasing = <span class="code-keyword">TRUE</span>))[<span class="code-keyword">1</span>], 
                               as.character(.))) %>%
  mutate_if(is.factor, as.factor)

<span class="code-comment"># Reportar cambios</span>
cat(<span class="code-string">"üßπ RESULTADOS DE LA LIMPIEZA:\n"</span>)
cat(<span class="code-string">"=============================\n"</span>)
cat(<span class="code-string">"Filas originales:"</span>, nrow(df), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Filas despu√©s de limpieza:"</span>, nrow(df_clean), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Filas eliminadas:"</span>, nrow(df) - nrow(df_clean), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Valores faltantes originales:"</span>, sum(is.na(df)), <span class="code-string">"\n"</span>)
cat(<span class="code-string">"Valores faltantes despu√©s:"</span>, sum(is.na(df_clean)), <span class="code-string">"\n"</span>)</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üìä</span>
                            <span>Validaci√≥n estad√≠stica</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># An√°lisis comparativo antes/despu√©s</span>
cat(<span class="code-string">"\nüìä COMPARACI√ìN ESTAD√çSTICA ANTES/DESPU√âS:\n"</span>)

<span class="code-comment"># Funci√≥n para comparar estad√≠sticas</span>
compare_stats <- function(original, cleaned, col_name) {
  <span class="code-keyword">if</span>(is.numeric(original[[col_name]])) {
    cat(<span class="code-string">"\nColumna:"</span>, col_name, <span class="code-string">"\n"</span>)
    cat(<span class="code-string">"  Media original:"</span>, round(mean(original[[col_name]], na.rm = <span class="code-keyword">TRUE</span>), <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
    cat(<span class="code-string">"  Media limpia:"</span>, round(mean(cleaned[[col_name]], na.rm = <span class="code-keyword">TRUE</span>), <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
    cat(<span class="code-string">"  Desv. est√°ndar original:"</span>, round(sd(original[[col_name]], na.rm = <span class="code-keyword">TRUE</span>), <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
    cat(<span class="code-string">"  Desv. est√°ndar limpia:"</span>, round(sd(cleaned[[col_name]], na.rm = <span class="code-keyword">TRUE</span>), <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
  }
}

<span class="code-comment"># Aplicar comparaci√≥n a columnas num√©ricas</span>
numeric_columns <- names(select_if(df, is.numeric))
<span class="code-keyword">for</span>(col <span class="code-keyword">in</span> numeric_columns) {
  compare_stats(df, df_clean, col)
}

<span class="code-comment"># Visualizaci√≥n de mejoras</span>
<span class="code-keyword">if</span>(length(numeric_columns) >= <span class="code-keyword">2</span>) {
  <span class="code-comment"># Gr√°fico de correlaci√≥n antes y despu√©s</span>
  par(mfrow = c(<span class="code-keyword">1</span>, <span class="code-keyword">2</span>))
  
  <span class="code-comment"># Correlaci√≥n original</span>
  cor_original <- cor(select_if(df, is.numeric), use = <span class="code-string">"complete.obs"</span>)
  corrplot(cor_original, method = <span class="code-string">"color"</span>, title = <span class="code-string">"Correlaciones Originales"</span>,
           mar = c(<span class="code-keyword">0</span>,<span class="code-keyword">0</span>,<span class="code-keyword">1</span>,<span class="code-keyword">0</span>))
  
  <span class="code-comment"># Correlaci√≥n despu√©s de limpieza</span>
  cor_clean <- cor(select_if(df_clean, is.numeric), use = <span class="code-string">"complete.obs"</span>)
  corrplot(cor_clean, method = <span class="code-string">"color"</span>, title = <span class="code-string">"Correlaciones Post-Limpieza"</span>,
           mar = c(<span class="code-keyword">0</span>,<span class="code-keyword">0</span>,<span class="code-keyword">1</span>,<span class="code-keyword">0</span>))
  
  cat(<span class="code-string">"\nüìà Gr√°ficos de correlaci√≥n generados\n"</span>)
}</div>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-cleaning">
                    <label for="r-cleaning">‚úÖ Pipeline de limpieza con Tidyverse ejecutado y validado</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Imputaci√≥n Avanzada con MICE</div>
                    <div class="time-estimate">‚è±Ô∏è 8 min</div>
                </div>

                <div style="background: rgba(46, 213, 115, 0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <h4>üéØ MICE (Multiple Imputation by Chained Equations):</h4>
                    <p>Esta es una t√©cnica avanzada que R maneja excepcionalmente bien. MICE crea m√∫ltiples 
                    imputaciones basadas en patrones estad√≠sticos de los datos.</p>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üî¨</span>
                            <span>Imputaci√≥n avanzada con MICE</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># Solo ejecutar si hay valores faltantes significativos</span>
<span class="code-keyword">if</span>(sum(is.na(df)) > <span class="code-keyword">0</span>) {
  cat(<span class="code-string">"üî¨ INICIANDO IMPUTACI√ìN AVANZADA CON MICE\n"</span>)
  
  <span class="code-comment"># Preparar datos para MICE (solo columnas con faltantes)</span>
  cols_with_missing <- names(df)[colSums(is.na(df)) > <span class="code-keyword">0</span>]
  
  <span class="code-keyword">if</span>(length(cols_with_missing) > <span class="code-keyword">0</span>) {
    cat(<span class="code-string">"Columnas con valores faltantes:"</span>, paste(cols_with_missing, collapse = <span class="code-string">", "</span>), <span class="code-string">"\n"</span>)
    
    <span class="code-comment"># Configurar MICE</span>
    mice_setup <- mice(df, m = <span class="code-keyword">5</span>, method = <span class="code-string">'pmm'</span>, printFlag = <span class="code-keyword">FALSE</span>)
    
    <span class="code-comment"># Realizar imputaci√≥n m√∫ltiple</span>
    cat(<span class="code-string">"Ejecutando imputaci√≥n m√∫ltiple...\n"</span>)
    mice_result <- complete(mice_setup)
    
    <span class="code-comment"># Comparar resultados</span>
    cat(<span class="code-string">"\nüìä COMPARACI√ìN MICE vs IMPUTACI√ìN SIMPLE:\n"</span>)
    <span class="code-keyword">for</span>(col <span class="code-keyword">in</span> cols_with_missing) {
      <span class="code-keyword">if</span>(is.numeric(df[[col]])) {
        original_mean <- mean(df[[col]], na.rm = <span class="code-keyword">TRUE</span>)
        simple_mean <- mean(df_clean[[col]], na.rm = <span class="code-keyword">TRUE</span>)
        mice_mean <- mean(mice_result[[col]], na.rm = <span class="code-keyword">TRUE</span>)
        
        cat(<span class="code-string">"Columna"</span>, col, <span class="code-string">":\n"</span>)
        cat(<span class="code-string">"  Media original (sin NAs):"</span>, round(original_mean, <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
        cat(<span class="code-string">"  Media imputaci√≥n simple:"</span>, round(simple_mean, <span class="code-keyword">2</span>), <span class="code-string">"\n"</span>)
        cat(<span class="code-string">"  Media imputaci√≥n MICE:"</span>, round(mice_mean, <span class="code-keyword">2</span>), <span class="code-string">"\n\n"</span>)
      }
    }
    
    <span class="code-comment"># Opci√≥n de usar resultado MICE</span>
    cat(<span class="code-string">"üí° MICE completado. Usando imputaci√≥n simple para este ejercicio.\n"</span>)
  }
} <span class="code-keyword">else</span> {
  cat(<span class="code-string">"‚úÖ No hay valores faltantes para imputaci√≥n avanzada\n"</span>)
}</div>
                </div>

                <div class="alert alert-success">
                    <span style="font-size: 1.2rem;">üèÜ</span>
                    <strong>Superioridad de R:</strong> MICE y otros m√©todos estad√≠sticos avanzados son 
                    mucho m√°s f√°ciles de implementar en R que en otras plataformas.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-mice">
                    <label for="r-mice">‚úÖ Imputaci√≥n avanzada evaluada (MICE ejecutado si aplicaba)</label>
                </div>
            </div>

            <div class="step">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Visualizaci√≥n Final y Exportaci√≥n</div>
                    <div class="time-estimate">‚è±Ô∏è 7 min</div>
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <div class="code-title">
                            <span>üìà</span>
                            <span>Crear visualizaci√≥n final (ggplot2)</span>
                        </div>
                        <div class="code-actions">
                            <button class="code-btn" onclick="selectCode(this)">üìã Seleccionar</button>
                            <button class="code-btn" onclick="copyCode(this)">üìÑ Copiar</button>
                        </div>
                    </div>
                    <div class="code-block"><span class="code-comment"># Crear dashboard de validaci√≥n con ggplot2</span>
library(gridExtra)

<span class="code-comment"># 1. Comparaci√≥n de distribuciones antes/despu√©s</span>
create_comparison_plot <- function(original, cleaned, column_name) {
  <span class="code-keyword">if</span>(is.numeric(original[[column_name]])) {
    <span class="code-comment"># Preparar datos para ggplot</span>
    plot_data <- data.frame(
      Valor = c(original[[column_name]], cleaned[[column_name]]),
      Tipo = rep(c(<span class="code-string">"Original"</span>, <span class="code-string">"Limpio"</span>), 
                 times = c(length(original[[column_name]]), 
                          length(cleaned[[column_name]])))
    )
    
    <span class="code-comment"># Crear gr√°fico de densidad</span>
    ggplot(plot_data, aes(x = Valor, fill = Tipo)) +
      geom_density(alpha = <span class="code-keyword">0.7</span>) +
      scale_fill_manual(values = c(<span class="code-string">"Original"</span> = <span class="code-string">"coral"</span>, <span class="code-string">"Limpio"</span> = <span class="code-string">"lightblue"</span>)) +
      labs(title = paste(<span class="code-string">"Distribuci√≥n:"</span>, column_name),
           x = column_name, y = <span class="code-string">"Densidad"</span>) +
      theme_minimal() +
      theme(legend.position = <span class="code-string">"bottom"</span>)
  }
}

<span class="code-comment"># Generar gr√°ficos para las primeras 4 columnas num√©ricas</span>
numeric_cols <- names(select_if(df, is.numeric))[<span class="code-keyword">1</span>:min(<span class="code-keyword">4</span>, length(names(select_if(df, is.numeric))))]
plots <- list()

<span class="code-keyword">for</span>(i <span class="code-keyword">in</span> seq_along(numeric_cols)) {
  plots[[i]] <- create_comparison_plot(df, df_clean, numeric_cols[i])
}

<span class="code-comment"># Combinar gr√°ficos</span>
<span class="code-keyword">if</span>(length(plots) > <span class="code-keyword">0</span>) {
  do.call(grid.arrange, c(plots, ncol = <span class="code-keyword">2</span>))
  cat(<span class="code-string">"üìä Gr√°ficos de comparaci√≥n generados\n"</span>)
}

<span class="code-comment"># 2. Resumen final elegante</span>
cat(<span class="code-string">"\n"</span> , <span class="code-string">"="</span>*<span class="code-keyword">60</span>, <span class="code-string">"\n"</span>)
cat(<span class="code-string">"üéâ REPORTE FINAL DE LIMPIEZA EN R\n"</span>)
cat(<span class="code-string">"="</span>*<span class="code-keyword">60</span>, <span class="code-string">"\n"</span>)

summary_data <- data.frame(
  M√©trica = c(<span class="code-string">"Filas totales"</span>, <span class="code-string">"Columnas"</span>, <span class="code-string">"Valores faltantes"</span>, 
              <span class="code-string">"Duplicados"</span>, <span class="code-string">"Memoria (MB)"</span>),
  Antes = c(nrow(df), ncol(df), sum(is.na(df)), 
           sum(duplicated(df)), 
           round(as.numeric(object.size(df)) / <span class="code-keyword">1024</span>^<span class="code-keyword">2</span>, <span class="code-keyword">2</span>)),
  Despu√©s = c(nrow(df_clean), ncol(df_clean), sum(is.na(df_clean)), 
             sum(duplicated(df_clean)), 
             round(as.numeric(object.size(df_clean)) / <span class="code-keyword">1024</span>^<span class="code-keyword">2</span>, <span class="code-keyword">2</span>))
)

summary_data$Cambio <- summary_data$Despu√©s - summary_data$Antes
print(summary_data)

<span class="code-comment"># 3. Guardar resultados</span>
write_csv(df_clean, <span class="code-string">"dataset_limpio_r.csv"</span>)
cat(<span class="code-string">"\nüíæ Dataset limpio guardado como 'dataset_limpio_r.csv'\n"</span>)

<span class="code-comment"># 4. Crear reporte HTML</span>
cat(<span class="code-string">"\nüìÑ Generando reporte HTML...\n"</span>)
rmarkdown::render(input = <span class="code-string">"reporte_limpieza.Rmd"</span>, 
                  output_file = <span class="code-string">"reporte_limpieza.html"</span>,
                  quiet = <span class="code-keyword">TRUE</span>)
cat(<span class="code-string">"‚úÖ Reporte HTML generado: 'reporte_limpieza.html'\n"</span>)</div>
                </div>

                <div class="alert alert-success">
                    <span style="font-size: 1.2rem;">üé®</span>
                    <strong>Arte de R:</strong> ggplot2 crea visualizaciones m√°s elegantes y personalizables 
                    que cualquier otra herramienta. R tambi√©n puede generar reportes autom√°ticos en HTML/PDF.
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="r-completed">
                    <label for="r-completed">‚úÖ Visualizaci√≥n final creada y dataset exportado con reporte</label>
                </div>
            </div>
        </div>

        <!-- COMPARACI√ìN FINAL -->
        <div class="section">
            <h2>üèÜ COMPARACI√ìN FINAL DE PLATAFORMAS</h2>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <h3>ü•á Power BI - El Velocista</h3>
                    <div class="speed-indicator">
                        <strong>Tiempo total estimado:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-fast" style="width: 95%;"></div>
                        </div>
                        <span>30 min</span>
                    </div>
                    <h4>üéØ Mejor para:</h4>
                    <ul>
                        <li>Usuarios de negocio</li>
                        <li>Limpieza r√°pida y b√°sica</li>
                        <li>Integraci√≥n con Microsoft</li>
                        <li>Presentaciones ejecutivas</li>
                    </ul>
                </div>

                <div class="comparison-card">
                    <h3>ü•à Python - El Todoterreno</h3>
                    <div class="speed-indicator">
                        <strong>Tiempo total estimado:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-medium" style="width: 70%;"></div>
                        </div>
                        <span>60 min</span>
                    </div>
                    <h4>üéØ Mejor para:</h4>
                    <ul>
                        <li>Data Scientists</li>
                        <li>Limpieza compleja y automatizada</li>
                        <li>Machine Learning posterior</li>
                        <li>Producci√≥n y escalabilidad</li>
                    </ul>
                </div>

                <div class="comparison-card">
                    <h3>ü•â R - El Estad√≠stico</h3>
                    <div class="speed-indicator">
                        <strong>Tiempo total estimado:</strong>
                        <div class="speed-bar">
                            <div class="speed-fill speed-medium" style="width: 65%;"></div>
                        </div>
                        <span>70 min</span>
                    </div>
                    <h4>üéØ Mejor para:</h4>
                    <ul>
                        <li>Investigadores y acad√©micos</li>
                        <li>An√°lisis estad√≠stico profundo</li>
                        <li>Visualizaciones publicables</li>
                        <li>Imputaci√≥n avanzada</li>
                    </ul>
                </div>
            </div>

            <div class="alert alert-info">
                <span style="font-size: 1.5rem;">üéì</span>
                <div>
                    <strong>Recomendaci√≥n del profesor:</strong> Domina las tres plataformas. En tu carrera 
                    profesional usar√°s diferentes herramientas seg√∫n el contexto, equipo y objetivos del proyecto.
                </div>
            </div>
        </div>

        <!-- CHECKLIST FINAL -->
        <div class="section">
            <h2>‚úÖ CHECKLIST FINAL DE VALIDACI√ìN</h2>

            <div class="step">
                <h3>üìã Antes de terminar, verifica que hayas completado:</h3>
                
                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-powerbi">
                    <label for="final-powerbi">‚úÖ Power BI: Dataset limpio cargado y transformaciones documentadas</label>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-python">
                    <label for="final-python">‚úÖ Python: Notebook completo con an√°lisis exploratorio y limpieza</label>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-r">
                    <label for="final-r">‚úÖ R: Script con pipeline Tidyverse y visualizaciones ggplot2</label>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-files">
                    <label for="final-files">‚úÖ Archivos exportados: 3 datasets limpios (uno por plataforma)</label>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-comparison">
                    <label for="final-comparison">‚úÖ Comparaci√≥n documentada: pros/contras de cada plataforma</label>
                </div>

                <div class="checkpoint" onclick="toggleCheckpoint(this)">
                    <input type="checkbox" id="final-reflection">
                    <label for="final-reflection">‚úÖ Reflexi√≥n personal: ¬øCu√°l plataforma prefieres y por qu√©?</label>
                </div>
            </div>

            <div class="alert alert-success" id="completion-message" style="display: none;">
                <span style="font-size: 2rem;">üéâ</span>
                <div>
                    <strong>¬°FELICITACIONES!</strong> Has completado exitosamente la pr√°ctica de limpieza de datos 
                    en las tres plataformas principales. Est√°s listo para la Actividad 5.
                </div>
            </div>
        </div>

        <!-- PR√ìXIMOS PASOS -->
        <div class="section">
            <h2>üöÄ PR√ìXIMOS PASOS</h2>

            <div class="alert alert-warning">
                <span style="font-size: 1.5rem;">üìÖ</span>
                <div>
                    <strong>Actividad 5 - Tratamiento de Informaci√≥n:</strong><br>
                    <strong>Entrega:</strong> 23 de junio 2025<br>
                    <strong>Valor:</strong> 13 puntos<br>
                    <strong>Dataset:</strong> Recibir√°s tu asignaci√≥n espec√≠fica por email esta tarde
                </div>
            </div>

            <h3>üìù Para la Actividad 5 deber√°s entregar:</h3>
            <ol>
                <li><strong>Reporte de calidad:</strong> Estado inicial vs final de tu dataset</li>
                <li><strong>C√≥digo documentado:</strong> Scripts de limpieza en tu plataforma preferida</li>
                <li><strong>Visualizaciones:</strong> Gr√°ficos antes/despu√©s de la limpieza</li>
                <li><strong>Reflexi√≥n cr√≠tica:</strong> Decisiones tomadas y justificaci√≥n</li>
            </ol>

            <h3>üéØ Recomendaciones finales:</h3>
            <ul>
                <li><strong>Experimenta:</strong> Prueba diferentes enfoques en cada plataforma</li>
                <li><strong>Documenta todo:</strong> Cada decisi√≥n debe estar justificada</li>
                <li><strong>Compara resultados:</strong> ¬øLos tres enfoques dan resultados similares?</li>
                <li><strong>Pregunta:</strong> Usa el foro o env√≠a email si tienes dudas</li>
            </ul>

            <div style="text-align: center; margin-top: 30px;">
                <div style="font-size: 3rem;">üéì‚ú®üöÄ</div>
                <h2>¬°√âxito en tu Actividad 5!</h2>
                <p><strong>Prof. Fausto No√© Jim√©nez</strong><br>
                Universidad del SABES<br>
                fausto.noej@sabes.edu.mx</p>
            </div>
        </div>
    </div>

    <script>
        let checkpoints = {};
        let platformProgress = {
            powerbi: 0,
            python: 0,
            r: 0
        };

        function selectDataset(type) {
            // Deseleccionar todas las opciones
            document.querySelectorAll('.dataset-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Seleccionar la opci√≥n clickeada
            event.currentTarget.classList.add('selected');
            
            console.log('Dataset seleccionado:', type);
        }

        function toggleCheckpoint(element) {
            // Prevenir que se active dos veces si se hace clic en el checkbox directamente
            if (event.target.type === 'checkbox') {
                return;
            }
            
            const checkbox = element.querySelector('input[type="checkbox"]');
            const checkboxId = checkbox.id;
            
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('completed');
                checkpoints[checkboxId] = true;
            } else {
                element.classList.remove('completed');
                checkpoints[checkboxId] = false;
            }
            
            updateProgress();
        }

        // Funci√≥n adicional para manejar clicks directos en checkboxes
        function handleCheckboxChange(checkbox) {
            const checkboxId = checkbox.id;
            const element = checkbox.closest('.checkpoint');
            
            if (checkbox.checked) {
                element.classList.add('completed');
                checkpoints[checkboxId] = true;
            } else {
                element.classList.remove('completed');
                checkpoints[checkboxId] = false;
            }
            
            updateProgress();
        }

        function updateProgress() {
            // Calcular progreso por plataforma con checkpoints actualizados
            const powerbiChecks = ['dataset-downloaded', 'pbi-completed', 'pbi-exploration', 'pbi-basic-cleaning', 'pbi-missing-values', 'pbi-outliers', 'pbi-transformations', 'pbi-final'];
            const pythonChecks = ['colab-setup', 'python-data-loaded', 'python-exploration', 'python-cleaning', 'python-completed'];
            const rChecks = ['r-setup', 'r-libraries', 'r-exploration', 'r-cleaning', 'r-mice', 'r-completed'];
            
            platformProgress.powerbi = calculatePlatformProgress(powerbiChecks);
            platformProgress.python = calculatePlatformProgress(pythonChecks);
            platformProgress.r = calculatePlatformProgress(rChecks);
            
            // Calcular progreso general
            const totalChecks = Object.keys(checkpoints).length;
            const completedChecks = Object.values(checkpoints).filter(Boolean).length;
            const overallProgress = totalChecks > 0 ? (completedChecks / totalChecks) * 100 : 0;
            
            // Actualizar interfaz
            document.getElementById('overallProgress').style.width = overallProgress + '%';
            document.getElementById('progressText').textContent = Math.round(overallProgress) + '% completado';
            
            document.getElementById('powerbiProgress').textContent = `üìä Power BI: ${Math.round(platformProgress.powerbi)}%`;
            document.getElementById('pythonProgress').textContent = `üêç Python: ${Math.round(platformProgress.python)}%`;
            document.getElementById('rProgress').textContent = `üìà R: ${Math.round(platformProgress.r)}%`;
            
            // Mostrar mensaje de completaci√≥n si todo est√° hecho
            const finalChecks = ['final-powerbi', 'final-python', 'final-r', 'final-files', 'final-comparison', 'final-reflection'];
            const finalCompleted = finalChecks.every(id => checkpoints[id]);
            
            if (finalCompleted) {
                document.getElementById('completion-message').style.display = 'block';
            }
        }

        function selectCode(button) {
            const codeBlock = button.closest('.code-container').querySelector('.code-block');
            
            // Crear un rango de selecci√≥n
            if (window.getSelection) {
                const selection = window.getSelection();
                const range = document.createRange();
                range.selectNodeContents(codeBlock);
                selection.removeAllRanges();
                selection.addRange(range);
                
                // Feedback visual
                button.textContent = '‚úÖ Seleccionado';
                setTimeout(() => {
                    button.textContent = 'üìã Seleccionar';
                }, 2000);
            }
        }

        function copyCode(button) {
            const codeBlock = button.closest('.code-container').querySelector('.code-block');
            const codeText = codeBlock.textContent;
            
            // Copiar al portapapeles
            navigator.clipboard.writeText(codeText).then(() => {
                // Feedback visual
                button.textContent = '‚úÖ Copiado';
                button.style.background = 'rgba(46, 213, 115, 0.3)';
                
                setTimeout(() => {
                    button.textContent = 'üìÑ Copiar';
                    button.style.background = 'rgba(255, 255, 255, 0.2)';
                }, 2000);
            }).catch(err => {
                // Fallback para navegadores que no soportan clipboard API
                console.error('Error al copiar:', err);
                
                // Seleccionar el texto como fallback
                selectCode(button.parentElement.querySelector('.code-btn'));
                
                button.textContent = 'üìã Seleccionado';
                setTimeout(() => {
                    button.textContent = 'üìÑ Copiar';
                }, 2000);
            });
        }

        function calculatePlatformProgress(checkIds) {
            const completed = checkIds.filter(id => checkpoints[id]).length;
            return checkIds.length > 0 ? (completed / checkIds.length) * 100 : 0;
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // Agregar event listeners a todos los checkboxes
            document.querySelectorAll('.checkpoint input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    handleCheckboxChange(this);
                });
            });
            
            updateProgress();
        });
    </script>
</body>
</html>
